3.4節で定義したナップサック問題アプローチに基づき、レビュー労力の計算を実装する。本節では、実装の詳細とデータセットへの適用について述べる。

\paragraph{実装の詳細}
各コミット $i$ のレビュー労力 $W_i$ を計算するため、以下の手順を実行する。

まず、コミットの基本情報を取得する。
\begin{itemize}
    \item 追加されたコード行数 $LA_i$
    \item 削除されたコード行数 $LD_i$
    \item 変更されたファイル数 $N_i$
    \item 各ファイル $k$ の変更行数
\end{itemize}

次に、3.4節で定義した計算式を順次適用する。

コードの変更行数 $C_i$ を計算する。
\[
C_i = LA_i + LD_i
\]

各ファイルが変更全体に占める割合 $p_k$ を計算する。
\[
p_k = \frac{\text{file}_k \text{の変更行数}}{\text{全変更行数}}
\]

変更の広がり $H_i$ を計算する。
\[
H_i = -\sum_{k=1}^{n_i} p_k \log_2 p_k
\]

変更の広がりを正規化する。
\[
H_i^{\text{norm}} = \frac{H_i}{\log_2 n_i}
\]

ベース労力 $E_{\text{raw}, i}$ を計算する。
\[
E_{\text{raw}, i} = C_i \times N_i^{H_i^{\text{norm}}}
\]

対数変換により補正済み労力 $W_i$ を計算する。
\[
W_i = E_{\text{adj}, i} = \ln(E_{\text{raw}, i} + 1)
\]

\paragraph{レビュー総労力の設定}
3.4節で定義した方法に従い、レビューに使える総労力 $C_{total}$ を設定する。全コミットをレビュー労力 $W_i$ の昇順にソートし、上位80\%のコミットの労力の和を $C_{total}$ とする。

\paragraph{密度の計算}
3.4節で定義した密度 $D_i$ を計算する。

\[
D_i = \frac{V_i}{W_i} = \frac{\hat{y}_i}{E_{\text{adj}, i}}
\]

ここで、$\hat{y}_i$ はモデルが予測したコミット $i$ の欠陥混入確率、$E_{\text{adj}, i}$ はコミット $i$ の補正済みレビュー労力である。密度は貪欲法におけるレビュー対象の優先順位付けに用いられる。

\paragraph{データセットへの適用}
BugHunterデータセットに含まれる各コミットについて、上記の手順に従ってレビュー労力 $W_i$ と密度 $D_i$ を算出する。これらの値は、貪欲法によるレビュー対象選択の入力として使用される。