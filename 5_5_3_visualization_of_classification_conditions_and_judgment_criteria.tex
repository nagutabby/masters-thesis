決定木の分類ルールを分析すると、ベースラインとステップ3で使用される特徴量が大きく異なることが明らかになった。表\ref{tab:decision_tree_features}に、各プロジェクトで使用された主要な特徴量を示す。

\begin{table}[ht]
\centering
\caption{決定木で使用された主要な特徴量}
\label{tab:decision_tree_features}
\begin{tabular}{|l|p{5cm}|p{6cm}|}
\hline
プロジェクト & ベースライン & ステップ3 \\
\hline
Elasticsearch & MI, TF-IDF, NII & tokens\_change, lines\_added, operation\_type\_added, HNDB, lines\_deleted \\
\hline
Hazelcast & NOI, TF-IDF, HTRP, NII, MISM & NOI, NII, tokens\_change, HNDB, lines\_added, num\_files \\
\hline
Neo4j & NII, TF-IDF, HCPL, MIMS, HDIF, NOI, HVOL & lines\_deleted, lines\_added, operation\_type\_NaN, TF-IDF, tokens\_change, entropy \\
\hline
Netty & TF-IDF, NII, TLOC & tokens\_change, operation\_type\_NaN, lines\_deleted, TF-IDF, lines\_added, HNDB \\
\hline
OrientDB & Brace Rules, TF-IDF, TLLOC, WarningMinor, HVOL, MI & NII, MISEI, lines\_deleted, lines\_added, HVOL, HNDB \\
\hline
\end{tabular}
\end{table}

ベースラインでは、TF-IDFやMI、NIIといった静的コードメトリクスが主に使用されていた。一方、ステップ3では、全てのプロジェクトでtokens\_change、lines\_added、lines\_deletedといったコミット間の変化量メトリクスが上位の分割条件として採用された。特に、tokens\_changeとoperation\_type\_addedというメソッド単位の変化量メトリクスが、多くのプロジェクトで重要な分割条件となっている。

具体的な分類ルールを見ると、ステップ3では時系列変化を中心とした直感的な条件が多く出現した。例えば、Elasticsearchでは「lines\_added <= 103.5 AND operation\_type\_added <= 0.5 AND tokens\_change <= 0.5」という条件で陽性割合0.773となり、小規模な変更で既存メソッドのみを修正した場合にバグ混入リスクが高いことを示している。逆に、「lines\_added <= 103.5 AND operation\_type\_added > 0.5」という新規メソッド追加を含む条件では、陰性割合1.000となり、新規メソッドの追加がバグ混入リスクを低下させることが明確に示された。

Neo4jでは、「lines\_added <= 91.5 AND lines\_added <= 24.5」という小規模変更が陽性割合0.907、「lines\_added <= 91.5 AND lines\_added > 24.5 AND entropy > 0.954」という中規模で分散度の高い変更が陽性割合0.952となった。一方、「lines\_added > 91.5」という大規模変更では、tokens\_changeやlines\_deletedといった追加条件により陰性に分類されており、大規模変更が計画的に実施される傾向を反映している。

Nettyでは、tokens\_changeが最も重要な分割条件となり、「tokens\_change <= 0.5 AND lines\_deleted <= 54.5 AND tokens\_change > -0.5」という条件で陽性割合0.849を達成した。これは、メソッドのトークン数がわずかに変化した場合にバグ混入リスクが高いことを示している。逆に、「tokens\_change <= 0.5 AND lines\_deleted <= 54.5 AND tokens\_change <= -0.5」ではトークン数が減少(リファクタリングによる簡素化)した場合に陰性割合0.975となり、コードの整理がバグ混入リスクを低下させることが示された。

OrientDBでは、ステップ3で陽性リーフノードが2個から5個に増加し、より多様なバグ混入パターンを識別できるようになった。「lines\_added <= 104.5 AND HNDB > 30.887 AND lines\_deleted <= 14.5」という条件では陽性割合0.774となり、小規模な変更で複雑度が高い場合のリスクを捉えている。また、「lines\_added > 104.5 AND HVOL > 256.864 AND lines\_deleted > 1840.5」という大規模な変更でも陽性割合0.911となる条件が見つかり、大規模かつ複雑な変更にはリスクが伴うことが示された。

図\ref{fig:decision_tree_vis}に、代表例としてElasticsearchプロジェクトにおけるステップ3の決定木を示す。

\begin{figure}[ht]
\centering
\includegraphics[width=0.9\textwidth]{figures/elasticsearch/decision_tree_visualization.png}
\caption{決定木による分類ルールの可視化（Elasticsearch、ステップ3）}
\label{fig:decision_tree_vis}
\end{figure}